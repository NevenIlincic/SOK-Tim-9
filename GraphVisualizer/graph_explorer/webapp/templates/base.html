<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  {% load static %}
  <script type="text/javascript" src="https://d3js.org/d3.v7.min.js"></script>
  <link rel="stylesheet" href="{% static 'styles.css' %}">
  <title>GraphVisualizer</title>
</head>

<body>
  <div class="page">
    <div class="header">
      <div class="left-header">
        <a href="{% url 'index' %}">Graph Visualizer</a>
        <div class="views">
          <a href="{% url 'block_visualizer' %}"><button name="block-view">Block view</button></a>
          <a class="simple" href="{% url 'simple_visualizer' %}"><button class="simple-button" name="simple-view">Simple
              view</button></a>
        </div>
      </div>
      <div class="rigth-header">
        <form id="uploadForm" method="post" enctype="multipart/form-data" action="{% url 'load_file' %}">
          <div class="top-query">
            {% csrf_token %}
            <label>File:</label>
            <input type="file" name="load_file" onchange="document.getElementById('uploadForm').submit();">
        </form>
        <form id="resetGraphForm" method="post" action="{% url 'reset_graph' %}">
          {% csrf_token %}
          <button type="submit">Reset graph</button>
        </form>
        <form id="searchForm" method="post" action="{% url 'query_search' %}">
          {% csrf_token %}
          <label for="search">Search:</label>
          <input type="text" id="search" name="search" />
          <button type="submit">Search</button>
        </form>
      </div>
      <div class="mid-query">
        <form id="searchForm" method="post" action="{% url 'query_filter' %}">
          {% csrf_token %}
          <label>Filter:</label>
          <input name="filter"></input>
          <select id="relations" name="relations">
            <option value="=">=</option>
            <option value="<">&lt;</option>
            <option value=">">&gt;</option>
            <option value="<=">&le;</option>
            <option value=">=">&ge;</option>
          </select>
          <input name="value"></input>
          <button type="submit">Apply filter</button>
        </form>
      </div>
      <div class="bottom-query">
        <label for="applied-queries">Applied queries:</label>
        {% block filters %}{% endblock %}
      </div>
    </div>
  </div>
  <div class="main">
    <div class="left">
      <div class="top">{% block treeView %}{% endblock %}</div>
      <div class="bottom">{% block birdView %}{% endblock %}</div>
    </div>
    <div class="center">{% block mainView %}{% endblock %}</div>
  </div>
  <div class="footer">
            <div id="modern-terminal-container">
              <div class="terminal-header">
                <span class="terminal-title">TERMINAL</span>
              </div>
              <div class="terminal-body">
                <div class="terminal-output">
                  <span class="start-text">Modern Graph Visualizer Terminal.</span>
                  <span class="start-text">Unesite komandu za početak...</span>
                </div>
                <div class="terminal-input-wrapper">
                  <span class="prompt"> > </span>
                  <input type="text" class="terminal-input">
                </div>
              </div>
            </div>
        </div>
        <script>
    const terminalOutput = document.querySelector('.terminal-output');
    const terminalInput = document.querySelector('.terminal-input');

    // Funkcija koja dodaje liniju teksta u izlazni deo
    function appendLine(text, isCommand = false) {
        const line = document.createElement('div');
        line.innerHTML = `<span class="prompt">${isCommand ? '> ' : ''}</span><span class="line-text">${text}</span>`;
        terminalOutput.appendChild(line);
        terminalOutput.scrollTop = terminalOutput.scrollHeight; // Automatski skroluje na dno
    }

    // Slušaj pritisak na taster u input polju
    terminalInput.addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
            const command = this.value; // Dohvati uneseni tekst
            if (command.trim() !== '') {
                appendLine(command, true); // Ispiši unesenu komandu
                this.value = ''; // Obriši tekst iz input polja
            }
        }
    });

    // Postavi fokus na input polje kada se stranica učita
    window.addEventListener('load', function() {
        terminalInput.focus();
    });
</script>
  </div>
</body>

</html>